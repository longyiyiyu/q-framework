/*!
 * Qui.js v0.0.1
 * an ui library with q directives
 * (c) 2016 longyiyiyu
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Q=e():t.Q=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var r={version:"2.0.0"};n(1)(r,r),n(5)(r,r),n(10)(r,r),n(9)(r,r),t.exports=r},function(t,e,n){function r(t){return t=t.replace(/^q-/,""),u[t]}function i(t,e){e&&o.extend(e,{getDirective:r})}var o=n(2),s=n(3),a="qIf",u={text:function(t,e){s.setText(e,t)},html:function(t,e){s.setInnerHtml(e,t)},"class":function(t,e,n){var r,i,o=this.optMap[n.id];if(t){if(r=" "+(s.getClassName(e)||"")+" ","object"==typeof t)for(var a in t)if(t[a])r.indexOf(" "+a+" ")<0&&(r+=a+" ");else for(i=" "+a+" ";r.indexOf(i)>=0;)r=r.replace(i," ");else if("string"==typeof t){if(o.lastClassName)for(i=" "+o.lastClassName+" ";r.indexOf(i)>=0;)r=r.replace(i," ");r.indexOf(" "+t+" ")<0&&(r+=t+" "),o.lastClassName=t}s.setClassName(e,r.trim())}},attr:function(t,e){if(void 0!==t&&"object"==typeof t)for(var n in t)if(t.hasOwnProperty(n))if("style"===n)for(var r in t[n])t[n].hasOwnProperty(r)&&s.setStyle(e,o.camelize(r),t[n][r]);else n in e?e[n]=t[n]:s.setAttribute(e,n,t[n])},css:function(t,e){if(t&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&s.setStyle(e,o.camelize(n),t[n])},show:function(t,e){var n;t?(s.setStyle(e,"display",""),n=s.getStyle(e,"display"),"none"===n&&s.setStyle(e,"display","block")):s.setStyle(e,"display","none")},value:function(t,e){s.setValue(e,t)},on:function(t,e){var n=this;if(t&&"object"==typeof t&&!e.__Q__hasBindEvents){for(var r in t)t.hasOwnProperty(r)&&"function"==typeof t[r]&&!function(t,r){s.addEventListener(e,t,function(t){r.call(n,t)},!1)}(r,t[r]);e.__Q__hasBindEvents=1}},"if":function(t,e,n){var r,i=this.optMap[n.id],o=!!t;i.ref||(i.ref=document.createComment("q-if"),i.if_value=!0),o!==i.if_value&&(o?(r=s.getParentNode(i.ref),r&&s.replaceChild(r,e,i.ref),i.if_value=!0):(r=s.getParentNode(e),r&&s.replaceChild(r,i.ref,e),i.if_value=!1))},child:function(t,e){var n=this.optMap[e.id].el;a in t&&u["if"].call(this,t[a],n.getDom(),e),a in t||a in n?(n.update(t,!1),(t[a]||n[a])&&n.update(null,!0)):n.update(t)}};t.exports=i},function(t,e,n){function r(){return g++}function i(t,e){var n,r,o;if(t&&0!==t.length){t.length||(t=[t]);for(var s=0,a=t.length;s<a;++s)n=t[s],1===d.getNodeType(n)&&(o=e(n),o!==!1&&(o&&o!==!0&&(n=o),r=d.getChildNodes(n),r.length&&i(r,e)))}}function o(t){return 0===t.indexOf("q-")}function s(t,e,n){var r=d.getAttributes(t);n=n||o;for(var i=0,s=r.length;i<s;++i)n(r[i].name,r[i].value)&&e(r[i].name,r[i].value)}function a(t,e){var n;e=[].splice.call(arguments,1);for(var r=0,i=e.length;r<i;++r){n=e[r];for(var o in n)t[o]=n[o]}return t}function u(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function c(t,e){for(var n,r,i={},o=0,s=t.length;o<s;o++)n=t[o],r=n[e],r&&(i[r]=n);return i}function l(t,e){t.push({index:e,type:h.REMOVE})}function f(t,e,n){t.push({index:e,item:n,type:h.INSERT})}function h(t,e,n){for(var r,i,o,s,a=c(t,n),u=c(e,n),h=[],p=[],d=0;d<t.length;){if(r=t[d],i=r[n],!i)throw new Error("there is an item without key in oldList!");i in u?p.push(a[i]):p.push(null),d++}for(d=0;d<p.length;)null===p[d]?(l(h,d),p.splice(d,1)):d++;for(var g,m=d=0,v={};d<e.length;){if(r=e[d],i=r[n],o=p[m],s=(o||{})[n],o)if(i===s)m++;else if(a.hasOwnProperty(i)){for(;s in v;)delete v[s],p.splice(m,1),o=p[m],s=(o||{})[n];g=(p[m+1]||{})[n],g===i?(l(h,d),p.splice(m,1),m++):(f(h,d,a[i]),v[i]=1)}else f(h,d);else f(h,d);d++}return h}function p(t){return"[object Object]"=={}.toString.call(t)}var d=n(3),g=1;h.REMOVE=0,h.INSERT=1,t.exports={getId:r,walk:i,scan:s,listDiff:h,extend:a,noop:function(){},retTrue:function(){return!0},retFalse:function(){return!1},getRandomId:function(){return Math.ceil(1e6*Math.random())},camelize:u,isPlainObject:p}},function(t,e,n){function r(t){return P.getDomTree(t)}function i(t){return P.getDomString(t)}function o(t){return P.getInnerHtml(t)}function s(t,e){return P.setInnerHtml(t,e)}function a(t,e){return P.setText(t,e)}function u(t){return P.getNodeName(t)}function c(t){return P.getNodeType(t)}function l(t){return P.getParentNode(t)}function f(t){return P.getChildNodes(t)}function h(t){return P.getAttributes(t)}function p(t,e){return P.getAttribute(t,e)}function d(t,e,n){return P.setAttribute(t,e,n)}function g(t,e){return P.addClass(t,e)}function m(t,e){return P.removeClass(t,e)}function v(t,e,n){return P.replaceChild(t,e,n)}function y(t,e){return P.removeChild(t,e)}function w(t,e,n){return P.insertBefore(t,e,n)}function x(t){return P.getClassName(t)}function N(t,e){return P.setClassName(t,e)}function C(t,e){return P.getStyle(t,e)}function b(t,e,n){return P.setStyle(t,e,n)}function _(t,e){return P.setValue(t,e)}function D(t,e,n,r){return P.addEventListener(t,e,n,r)}var P=n(4);t.exports={getDomTree:r,getDomString:i,getInnerHtml:o,setInnerHtml:s,setText:a,getNodeType:c,getNodeName:u,getParentNode:l,getChildNodes:f,getAttributes:h,getAttribute:p,setAttribute:d,addClass:g,removeClass:m,replaceChild:v,removeChild:y,insertBefore:w,getClassName:x,setClassName:N,getStyle:C,setStyle:b,setValue:_,addEventListener:D}},function(t,e){var n=document.createElement("div"),r=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,i=[].slice;t.exports={getDomTree:function(t){var e;return r.test(t)&&(e=[$(document.createElement(RegExp.$1))]),e||(n.innerHTML=""+t,e=i.call(n.childNodes,0)),e},getDomString:function(t){return t.outerHTML},getInnerHtml:function(t){return t.innerHTML},setInnerHtml:function(t,e){return t.innerHTML=e},setText:function(t,e){return t.innerText=e},getNodeType:function(t){return t.nodeType},getNodeName:function(t){return t.nodeName.toLowerCase()},getParentNode:function(t){return t.parentNode},getChildNodes:function(t){return i.call(t.childNodes,0)},getAttributes:function(t){return t.attributes},getAttribute:function(t,e){return t.getAttribute(e)},setAttribute:function(t,e,n){return t.setAttribute(e,n)},addClass:function(t,e){if(t.classList)t.classList.add(e);else{var n=" "+(t.className||"")+" ";n.indexOf(" "+e+" ")<0&&(t.className=(n+e).trim())}},removeClass:function(t,e){if(t.classList)t.classList.remove(e);else{for(var n=" "+(t.className||"")+" ",r=" "+e+" ";n.indexOf(r)>=0;)n=n.replace(r," ");t.className=n.trim()}},replaceChild:function(t,e,n){return t.replaceChild(e,n)},insertBefore:function(t,e,n){return t.insertBefore(e,n)},removeChild:function(t,e){return t.removeChild(e)},getClassName:function(t){return t.className},setClassName:function(t,e){t.className=e},getStyle:function(t,e){return t.currentStyle?t.currentStyle[e]:getComputedStyle(t,null)[e]},setStyle:function(t,e,n){t.style[e]=n},setValue:function(t,e){"checkbox"===t.type?t.checked=!!e:t.value=e},addEventListener:function(t,e,n,r){t.addEventListener(e,n,r)}}},function(t,e,n){function r(t){var e,n,r,i={};return c.walk(t,function(t){return e=l.getNodeName(t),r=a(e),!r&&("yield"===e?(n=l.getAttribute(t,"to"),i[n]=t,!1):void 0)}),i}function i(t){var e={},n=!1;return c.scan(t,function(t,r){t!==g&&t!==d&&(n=!0,e[c.camelize(t)]=r)},c.retTrue),n?e:null}function o(t,e,n){e._html=t._html,e.children=[],e.optMap={},f(e,null,t),!n&&h(e)}function s(t,e){w[t.toLowerCase()]=e}function a(t){return w[t.toLowerCase()]}function u(t,e){e&&c.extend(e,{component:y,setComClass:s,getComClass:a})}var c=(n(6),n(2)),l=n(3),f=n(7),h=n(8),p=n(9),d="q-id-p",g="q-repeat",m={setParent:function(t){this.parent=t},getDom:function(){return this.root},getHtml:function(){return this.hasUpdated&&(this._html=l.getDomString(this.root),this.hasUpdated=!1),this._html},update:function(t,e){var n,r=this;"object"==typeof t&&(this._beforeUpdate(t)||(t&&this.trigger("update",t),n=e===!0||e!==!1&&(!this.shouldComponentUpdate||this.shouldComponentUpdate(t)),c.extend(this,t),n&&(this.dc(),this.hasUpdated=!0,r.trigger("updated")),r._afterUpdate()))},_beforeUpdate:function(t){return this.__updating?(this.__waitingProps=c.extend(this.__waitingProps||{},t),!0):(this.__updating=!0,void delete this.__waitingProps)},_afterUpdate:function(){this.__updating&&(this.__updating=!1,this.__waitingProps&&this.update(this.__waitingProps))}},v=c.extend({},m,{update:function(t){c.extend(this,t),this.dc()}}),y=function(t,e,n,s){var a,u=this,y=l.getDomTree(t)[0],w=l.getNodeName(y),x=function(t){var e,n=this,a={};o(x,this,s),t&&(e=l.getDomTree(t),a=r(e)),this.root=l.getDomTree(this._html)[0],c.walk(s?this.root:l.getChildNodes(this.root),function(e){var r,o,s,f,h,p,m,v,y=l.getNodeName(e),w=u.getComClass(y);if("yield"===y)return h=l.getAttribute(e,"from"),p=a[h],p?(l.replaceChild(l.getParentNode(e),p,e),p):(l.removeChild(l.getParentNode(e),e),!1);if(o=l.getAttribute(e,d),m=l.getAttribute(e,g),o)try{o=JSON.parse(o)}catch(x){console.log("parse ID_KEY error:",l.getAttribute(e,d)),o=[]}if(n.root!==e&&m)return v=u.component(l.getDomString(e),null,null,!0),f=new u.Repeat(v,t),n.children.push(f),f.setParent(n),1!==o&&(o&&o.length?s=o[0]:r&&(s=n.watch(m,u.getDirective("child"))),s&&(n.optMap[s]={el:f})),l.replaceChild(l.getParentNode(e),f.getDom(),e),!1;if(w)return f=new w(l.getInnerHtml(e)),n.children.push(f),f.setParent(n),1!==o&&(o&&o.length?s=o[0]:(r=i(e),r&&(s=n.watch(r,u.getDirective("child")))),s&&(n.optMap[s]={el:f})),n.root!==e?l.replaceChild(l.getParentNode(e),f.getDom(),e):n.root=f.getDom(),!1;if(1!==o)if(o&&o.length)for(var N=0,C=o.length;N<C;++N)n.optMap[o[N]]={el:e};else c.scan(e,function(t,r){if(t!==g&&t!==d){var i=n.watch(r,function(e,n){u.getDirective(t).call(this,e,this.optMap[n.id].el,n)});n.optMap[i]={el:e}}})}),!s&&this.init&&this.init(),c.extend(this,this.defaultProps)};return f(null,x.prototype),!s&&h(null,x.prototype),!s&&p(null,x.prototype),f(x,x),c.walk(s?y:l.getChildNodes(y),function(t){var e,n,r=l.getNodeName(t),o=u.getComClass(r),s=[];return"yield"===r||(n=l.getAttribute(t,g),t!==y&&n?(s.push(x.watch(n,u.getDirective("child"))),l.setAttribute(t,d,s.length?JSON.stringify(s):1),!1):o?(e=i(t),e&&s.push(x.watch(e,u.getDirective("child"))),l.setAttribute(t,d,s.length?JSON.stringify(s):1),!1):(c.scan(t,function(t,e){t!==g&&t!==d&&s.push(x.watch(e,function(e,n){u.getDirective(t).call(this,e,this.optMap[n.id].el,n)}))}),void l.setAttribute(t,d,s.length?JSON.stringify(s):1)))}),e=e||{},c.extend(x,{comName:s?"":w,_html:l.getDomString(y)},e.statics),delete e.statics,e.getDefaultProps&&"function"==typeof e.getDefaultProps&&(a=e.getDefaultProps(),a&&"object"==typeof a&&(x.prototype.defaultProps=a),delete e.getDefaultProps),c.extend(x.prototype,s?v:m,e),!s&&this.setComClass(w,x),x},w={};t.exports=u},function(t,e){function n(t,e){return t?n.compile(t).call(e,r):t}function r(t,e){n.errorHandler&&n.errorHandler(t)}function i(t){var e=o(t);return"try{return "!==e.slice(0,11)&&(e="return "+e),new Function("E",e+";")}function o(t){var e,n=[];return t=t.replace(h,'"'),e=s(t,n),n[0]&&(e=e.replace(p,function(t,e){return n[e].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})),e}function s(t,e){var n;return t=t.replace(f,function(t,n){return t.length>2&&!n?u+(e.push(t)-1)+"~":t}).replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1"),t=t.replace(g,function(t,e,r,i,o){return r&&(i=n?0:i+t.length,"this"!==r&&"global"!==r&&"window"!==r?(t=e+'("'+r+d+r,i&&(n="."===(o=o[i])||"("===o||"["===o)):i&&(n=!m.test(o.slice(i)))),t}),n&&(t="try{return "+t+"}catch(e){E(e,this)}"),t}var a={};n.compile=function(t){return t?a[t]||(a[t]=i(t)):t},n.errorHandler=null;var u="⁗",c=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'/g,l=c.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?(\/)[gim]*/.source,f=new RegExp(l,"g"),h=/\u2057/g,p=/\u2057(\d+)~/g,d='"in this?this:'+("object"!=typeof window?"global":"window")+").",g=/[,{][$\w]+(?=:)|(:|^ *|[^$\w\.])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|JSON|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,m=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;t.exports=n},function(t,e,n){function r(t,e,n,r){var i={id:h.getId(),raw:e,expr:n,trigger:r};return t.watcherMap[i.id]=i,t.watchers.push(i),i.id}function i(t){return"string"==typeof t?f.compile(t):"object"==typeof t?function(){var e={},n={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=f.compile(t[r]));return function(){var t={},r=!1;for(var i in e)t[i]=e[i].call(this),!r&&n&&n[i]!==t[i]&&(r=!0);return r&&(n=t),n}}():void 0}function o(t,e){var n,r,i,o;if(h.isPlainObject(t)){if(!h.isPlainObject(e))return!0;if(n=Object.keys(t),r=Object.keys(e),n.length!=r.length)return!0;for(i=0,o=n.length;i<o;++i)if(t[n[i]]!==e[n[i]])return!0;return!1}if(t instanceof Array){if(!e)return!0;if(t.length!==e.length)return!0;for(i=0,o=t.length;i<o;++i)if(arguments.callee(t[i],e[i]))return!0;return!1}return t!==e}function s(t){var e;if(h.isPlainObject(t)){e={};for(var n in t)e[n]=t[n]}else if(t instanceof Array){e=[];for(var r=0,i=t.length;r<i;++r)e.push(arguments.callee(t[r]))}else e=t;return e}function a(){for(var t,e,n=0,r=this.watchers.length;n<r;++n)t=this.watchers[n],e=t.expr.call(this),o(e,this.valueMap[t.id])&&(this.valueMap[t.id]=s(e),t.trigger.call(this,e,t))}function u(t,e){for(var n,r=0,i=this.watchers.length;r<i;++r)if(n=this.watchers[r],t===n.raw&&e===n.trigger){this.watchers.splice(r,1),delete this.watcherMap[n.id];break}}function c(t,e){return t?r(this,t,i(t),e):-1}function l(t,e,n){n=n||{},t&&h.extend(t,{valueMap:{},watcherMap:h.extend({},n.watcherMap),watchers:n.watchers?n.watchers.slice():[]}),e&&h.extend(e,{watch:c,unwatch:u,dc:a})}var f=n(6),h=n(2);t.exports=l},function(t,e,n){function r(t,e){var n,r,i;if(t&&"string"==typeof t){n=t.trim().split(" ");for(var o=0,s=n.length;o<s;o++)r=n[o],i=r.indexOf("."),r&&e((~i?r.substring(0,i):r).trim(),~i?r.slice(i+1).trim():null)}}function i(t,e){var n=this;return"function"!=typeof e?this:(r(t,function(t,r){"*"!==t&&((n.events[t]=n.events[t]||[]).push(e),e.ns=r)}),this)}function o(t,e,n){if(t)for(var r,i=0;r=t[i];++i)(e===r||n&&r.ns===n)&&t.splice(i--,1)}function s(t,e){var n=this;if(t&&"string"==typeof t)return"*"!==t.trim()||e?r(t,function(t,r){if("*"===t)for(var i in n.events)o(n.events[i],e,r);else r||e?o(n.events[t],e,r):n.events[t]=[]}):this.events={},this}function a(t,e){var n=this;return r(t,function(t,r){var i=t+(r?"."+r:""),o=function(){n.off(i,o),e.apply(n,arguments)};n.on(i,o)}),this}function u(t){for(var e,n=this,i=arguments.length,o=new Array(i),s=1;s<i;s++)o[s]=arguments[s];return r(t,function(t,r){e=(n.events[t]||[]).slice(0),o[0]={type:t};for(var i,s=0;i=e[s];++s)i.apply(n,o),e[s]!==i&&s--}),this}function c(t,e){t&&l.extend(t,{events:{}}),e&&l.extend(e,{on:i,off:s,one:a,trigger:u})}var l=n(2);t.exports=c},function(t,e,n){function r(t,e){if("string"!=typeof t&&(e=t,t=null),t&&e)return"object"!=typeof e&&"function"!=typeof e||(s[t]=e),this;if(e||"string"!=typeof t||(e=s[t]),!e)return this;e instanceof Array||(e=[e]);for(var n,r=0,i=e.length;r<i;++r)n=e[r],"string"==typeof n&&(n=s[n]),n&&("object"==typeof n?(n.init&&(n.init(this),delete n.init),o.extend(this,n)):"function"==typeof n&&n(this));return this}function i(t,e){e&&o.extend(e,{mixin:r})}var o=n(2),s={};t.exports=i},function(t,e,n){function r(t,e,n){for(var r,i;e<t.length;){if(r=t[e],i=r[l],i===n){t.splice(e,1);break}e++}}function i(t){var e,n,i;if(t instanceof Array){var o,s,c=u.getParentNode(this.root),f={};if(c){e=a.listDiff(this.items,t,l);for(var h=0,p=e.length;h<p;++h)n=e[h],i=n.index,o=n.item,n.type===a.listDiff.REMOVE?(s=this.items[i][l],s&&(f[s]=this.items[i]),u.removeChild(c,this.items[i].getDom()),this.items.splice(i,1)):(o||(o=this.pool.get(),o.parent=this.parent,delete o[l]),u.insertBefore(c,o.getDom(),(this.items[i]||this).getDom()),s=o[l],s&&(s in f?delete f[s]:r(this.items,i,s)),this.items.splice(i,0,o));var d;for(h=0;h<t.length;){if(o=this.items[h],!o)throw new Error("there is something wrong of listDiff!");s=o[l],s||(o[l]=t[h][l]||a.getRandomId()),d={__index:h},d[l]=o[l],o.update(a.extend(t[h],d)),h++}for(var g in f)this.pool.release(f[g])}}}function o(t,e){this.root=this.ref=document.createComment("q-repeat"),this.itemClass=t,this.pool=new c(this.itemClass,e),this.items=[]}function s(t,e){e&&a.extend(e,{Repeat:o})}var a=n(2),u=n(3),c=n(11),l="__repeatId";a.extend(o.prototype,{setParent:function(t){this.parent=t},update:i,getDom:function(){return this.root},getHtml:function(){return u.getDomString(this.root)}}),t.exports=s},function(t,e,n){function r(t,e){this.clazz=t,this.param=e,this.cache=[]}function i(){return this.cache.length?this.cache.pop():new this.clazz(this.param)}function o(t){this.cache.push(t)}var s=n(2);s.extend(r.prototype,{get:i,release:o}),t.exports=r}])});